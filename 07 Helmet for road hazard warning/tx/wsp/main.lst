C51 COMPILER V9.02   MAIN                                                                  03/01/2017 15:01:18 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\bin\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\app\main.c BROWSE INCDIR(..\drv\offchip_drivers\include;..\drv\onchip_dr
                    -ivers\include;..\app\include;..\drv) DEBUG OBJECTEXTEND PRINT(.\main.lst) OBJECT(..\bin\main.obj)

line level    source

   1          
   2          /*Defining all Header files */
   3          
   4          #include<reg52.h>
   5          #include<lcd4bit.h>
   6          #include<delay.h>
   7          #include<adc.h>
   8          #include<uart.h>
   9          
  10          #define IN 1
  11          #define OUT 0
  12          #define OFF 0
  13          #define ON 1
  14          #define MOBILE_SMSNO "AT+CMGS=\"+919989369233\""
  15          
  16          
  17          
  18          sbit BUZZER = P0^0;
  19          sbit TX433_D0 = P0^4;
  20          sbit TX433_D1 = P0^5;
  21          sbit TX433_D2 = P0^6;
  22          sbit TX433_D3 = P0^7;
  23          
  24          sbit HELMET = P0^1;
  25          sbit ALCOHOL = P0^2;
  26          sbit TILT = P0^3;
  27          unsigned char  alchohal = 0;
  28          
  29          /*Program in AT89S52 will starts executes from here */
  30          
  31          void Main()
  32          {
  33   1      
  34   1              unsigned char helmet_status =0,alcohol_status = 0, tilt_status = 0,error =0;
  35   1              init_lcd();      
  36   1              init_UART();
  37   1      
  38   1      
  39   1              HELMET = 1;
  40   1              ALCOHOL = 1;
  41   1              TILT = 1;
  42   1      
  43   1              TX433_D0 = OUT;
  44   1              TX433_D1 = OUT;
  45   1              TX433_D2 = OUT;
  46   1              TX433_D3 = OUT;
  47   1      
  48   1              BUZZER = OUT;
  49   1              BUZZER = OFF;
  50   1                      lcd_clear();
  51   1              gotoxy_lcd(1, 1);
  52   1              print_lcd("Helmet For Road");
  53   1              gotoxy_lcd(1, 2);
  54   1              print_lcd("   Safety");
C51 COMPILER V9.02   MAIN                                                                  03/01/2017 15:01:18 PAGE 2   

  55   1              BUZZER = ON;
  56   1      
  57   1              transmit_UARTDataString("AT"); delay_ms(50);
  58   1              transmit_UARTDataByte(0X0D);
  59   1      
  60   1              while(receive_UARTDataByte() != 'O');
  61   1              while(receive_UARTDataByte() != 'K');
  62   1      
  63   1              transmit_UARTDataString("ATE0"); delay_ms(50);
  64   1              transmit_UARTDataByte(0X0D);
  65   1      
  66   1              while(receive_UARTDataByte() != 'O');
  67   1              while(receive_UARTDataByte() != 'K');
  68   1      
  69   1              transmit_UARTDataString("AT+CPIN?"); delay_ms(100);transmit_UARTDataByte(0X0D);
  70   1              
  71   1              while(receive_UARTDataByte() != 'R');
  72   1              while(receive_UARTDataByte() != 'E');
  73   1              while(receive_UARTDataByte() != 'A');
  74   1              while(receive_UARTDataByte() != 'D');
  75   1              while(receive_UARTDataByte() != 'Y');
  76   1      
  77   1      
  78   1              transmit_UARTDataString("AT+CMGF=1");delay_ms(100);     transmit_UARTDataByte(0X0D);
  79   1              while(receive_UARTDataByte() != 'O');
  80   1              while(receive_UARTDataByte() != 'K');
  81   1      
  82   1              transmit_UARTDataString(MOBILE_SMSNO);  delay_ms(50);   transmit_UARTDataByte(0X0D);
  83   1              while(receive_UARTDataByte() != '>');
  84   1              transmit_UARTDataString("BIKE[AP xx TK 001] : STARTED WORKING");delay_ms(100);
  85   1              transmit_UARTDataByte(0X1A);
  86   1              while(receive_UARTDataByte() != 'O');
  87   1              while(receive_UARTDataByte() != 'K');
  88   1              
  89   1              BUZZER = OFF;           lcd_clear();
  90   1              
  91   1              while(1)
  92   1              {
  93   2              
  94   2                      
  95   2                      helmet_status = HELMET;
  96   2                      alcohol_status  = ALCOHOL;
  97   2                              tilt_status = TILT;
  98   2      
  99   2                      if(error == 0)
 100   2                      {
 101   3                              BUZZER = OFF;
 102   3                              TX433_D0 = 0;
 103   3                              TX433_D1 = 0;
 104   3                              TX433_D2 = 0;
 105   3                              TX433_D3 = 0;
 106   3                                      gotoxy_lcd(1, 1); print_lcd("Everthing OK");
 107   3      
 108   3                       
 109   3                      }                                                                                               
 110   2      
 111   2      
 112   2      
 113   2              
 114   2                      if(helmet_status == 0 && tilt_status ==1 && error ==0)
 115   2                      {
 116   3                              BUZZER = ON;
C51 COMPILER V9.02   MAIN                                                                  03/01/2017 15:01:18 PAGE 3   

 117   3                              TX433_D2 = 1;
 118   3                              TX433_D3 = 1; error = 1;        lcd_clear(); print_lcd("Fall detected");
 119   3      
 120   3      
 121   3              transmit_UARTDataString(MOBILE_SMSNO);  delay_ms(50);   transmit_UARTDataByte(0X0D);
 122   3              while(receive_UARTDataByte() != '>');
 123   3              transmit_UARTDataString("BIKE[AP xx TK 001] : EMERGENCY FALL DETECTED");delay_ms(100);
 124   3              transmit_UARTDataByte(0X1A);
 125   3              while(receive_UARTDataByte() != 'O');
 126   3              while(receive_UARTDataByte() != 'K');
 127   3                              delay_ms(250);
 128   3                      }
 129   2      
 130   2                              if(helmet_status == 0 && alcohol_status == 1 && error ==0)
 131   2                      {
 132   3                              BUZZER = ON;
 133   3                              TX433_D1 = 1;   TX433_D3 = 1;  error =1;        lcd_clear(); print_lcd("Alcohol detected");
 134   3      
 135   3      
 136   3      
 137   3              transmit_UARTDataString(MOBILE_SMSNO);  delay_ms(50);   transmit_UARTDataByte(0X0D);
 138   3              while(receive_UARTDataByte() != '>');
 139   3              transmit_UARTDataString("BIKE[AP xx TK 001]: ALCOHOL DETECTED");delay_ms(100);
 140   3              transmit_UARTDataByte(0X1A);
 141   3              while(receive_UARTDataByte() != 'O');
 142   3              while(receive_UARTDataByte() != 'K');
 143   3      
 144   3                              delay_ms(250);
 145   3                      }
 146   2      
 147   2                      if(helmet_status == 1)
 148   2                      {
 149   3                              
 150   3                              BUZZER = ON; 
 151   3                              TX433_D0 = 1;   TX433_D3 = 1;   lcd_clear(); print_lcd("No helmet");
 152   3      
 153   3                              delay_ms(250);   error = 0;
 154   3                              
 155   3                      }
 156   2      
 157   2         }
 158   1      
 159   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    577    ----
   CONSTANT SIZE    =    250    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
